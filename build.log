[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m----------------< [0;36mcom.datadistributor:data-distributor[0;1m >----------------[m
[[1;34mINFO[m] [1mBuilding data-distributor 0.0.1-SNAPSHOT[m
[[1;34mINFO[m] [1m--------------------------------[ jar ]---------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-clean-plugin:2.5:clean[m [1m(default-clean)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] Deleting /home/ashu/git/codex/data-distributor/target
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mjacoco-maven-plugin:0.8.11:prepare-agent[m [1m(default)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] argLine set to -javaagent:/home/ashu/.m2/repository/org/jacoco/org.jacoco.agent/0.8.11/org.jacoco.agent-0.8.11-runtime.jar=destfile=/home/ashu/git/codex/data-distributor/target/jacoco.exec
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:resources[m [1m(default-resources)[m @ [36mdata-distributor[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] Copying 1 resource
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.12.1:compile[m [1m(default-compile)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] Recompiling the module because of [1mchanged source code[m.
[[1;33mWARNING[m] File encoding has not been set, using platform encoding [1mUTF-8[m, i.e. build is platform dependent!
[[1;34mINFO[m] Compiling 86 source files with javac [debug target 17] to target/classes
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/main/java/com/datadistributor/outadapter/web/ReactiveSignalEventClient.java:[54,62] rawStatusCode() in org.springframework.web.reactive.function.client.ClientResponse has been deprecated and marked for removal
[[1;34mINFO[m] /home/ashu/git/codex/data-distributor/src/main/java/com/datadistributor/outadapter/web/ReactiveSignalEventClient.java: Some input files use or override a deprecated API.
[[1;34mINFO[m] /home/ashu/git/codex/data-distributor/src/main/java/com/datadistributor/outadapter/web/ReactiveSignalEventClient.java: Recompile with -Xlint:deprecation for details.
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mbuild-helper-maven-plugin:3.5.0:add-test-source[m [1m(add-test-source)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] Test Source directory: /home/ashu/git/codex/data-distributor/src/test/java/UnitTest added.
[[1;34mINFO[m] Test Source directory: /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest added.
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:testResources[m [1m(default-testResources)[m @ [36mdata-distributor[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] Copying 4 resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.12.1:testCompile[m [1m(default-testCompile)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] Recompiling the module because of [1mchanged dependency[m.
[[1;33mWARNING[m] File encoding has not been set, using platform encoding [1mUTF-8[m, i.e. build is platform dependent!
[[1;34mINFO[m] Compiling 58 source files with javac [debug target 17] to target/test-classes
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[37,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[37,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[37,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[37,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[37,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[38,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[38,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[38,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[38,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[38,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[39,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[39,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[39,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[39,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[39,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[40,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[40,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[40,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[40,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/SignalDispatchDomainSelectorIntegrationTest.java:[40,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/integration/FeignFailureIntegrationTest.java:[43,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/integration/FeignFailureIntegrationTest.java:[43,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/integration/FeignFailureIntegrationTest.java:[43,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/integration/FeignFailureIntegrationTest.java:[43,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;33mWARNING[m] /home/ashu/git/codex/data-distributor/src/test/java/IntegrationTest/com/datadistributor/integration/FeignFailureIntegrationTest.java:[43,4] org.springframework.boot.test.mock.mockito.MockBean in org.springframework.boot.test.mock.mockito has been deprecated and marked for removal
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-surefire-plugin:3.2.5:test[m [1m(default-test)[m @ [36mdata-distributor[0;1m ---[m
[[1;34mINFO[m] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[[1;34mINFO[m] 
[[1;34mINFO[m] -------------------------------------------------------
[[1;34mINFO[m]  T E S T S
[[1;34mINFO[m] -------------------------------------------------------
[[1;34mINFO[m] Running com.datadistributor.[1mSignalDispatchDomainSelectorIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:30:58.622+01:00  INFO 210330 --- [data-distributor] [           main] nalDispatchDomainSelectorIntegrationTest : Starting SignalDispatchDomainSelectorIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:30:58.699+01:00  INFO 210330 --- [data-distributor] [           main] nalDispatchDomainSelectorIntegrationTest : The following 1 profile is active: "test"
2025-12-07T22:31:05.088+01:00  INFO 210330 --- [data-distributor] [           main] nalDispatchDomainSelectorIntegrationTest : Started SignalDispatchDomainSelectorIntegrationTest in 12.209 seconds (process running for 18.08)
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.38 s -- in com.datadistributor.[1mSignalDispatchDomainSelectorIntegrationTest[m
[[1;34mINFO[m] Running com.datadistributor.inadapter.rest.[1mSignalEventControllerTest[m
2025-12-07T22:31:06.233+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.rest.SignalEventController         : Async job 17648c6b-0c3c-4ade-a0cf-a50816e2beff finished for 2024-12-03: success=1 failure=0 message=done
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.343 s -- in com.datadistributor.inadapter.rest.[1mSignalEventControllerTest[m
[[1;34mINFO[m] Running com.datadistributor.inadapter.rest.[1mJobStatusStoreTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s -- in com.datadistributor.inadapter.rest.[1mJobStatusStoreTest[m
[[1;34mINFO[m] Running com.datadistributor.inadapter.scheduler.[1mDialSignalDataProviderSchedulerTest[m
2025-12-07T22:31:06.516+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.s.DialSignalDataProviderScheduler  : DialSignalDataProvider running for date 2025-12-04
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.095 s -- in com.datadistributor.inadapter.scheduler.[1mDialSignalDataProviderSchedulerTest[m
[[1;34mINFO[m] Running com.datadistributor.inadapter.scheduler.[1mSignalEventSchedulerTest[m
2025-12-07T22:31:06.532+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler kicking off jobId=sched-mon-12-871d5eb8-c0c2-4f04-b683-fc22ab9e0239 for date=2024-12-02
2025-12-07T22:31:06.534+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler jobId=sched-mon-12-871d5eb8-c0c2-4f04-b683-fc22ab9e0239 for date=2024-12-02 finished. success=0 failure=0 message=ok
2025-12-07T22:31:06.632+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler kicking off jobId=sched-mon-10-10026ed9-1060-47c8-aa98-e58d4aa67b7c for date=2024-12-01
2025-12-07T22:31:06.633+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler jobId=sched-mon-10-10026ed9-1060-47c8-aa98-e58d4aa67b7c for date=2024-12-01 finished. success=0 failure=0 message=ok
2025-12-07T22:31:06.638+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : 2am schedule skipped for 2024-12-01 (SUNDAY)
2025-12-07T22:31:06.638+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : 2am schedule skipped for 2024-12-02 (MONDAY)
2025-12-07T22:31:06.678+01:00  WARN 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : LOG_004: 2am schedule disabled via config
2025-12-07T22:31:06.683+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler kicking off jobId=sched-2am-a07967b3-5797-4b62-82fc-de537d134dbd for date=2024-12-03
2025-12-07T22:31:06.689+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.scheduler.SignalEventScheduler     : Scheduler jobId=sched-2am-a07967b3-5797-4b62-82fc-de537d134dbd for date=2024-12-03 finished. success=0 failure=0 message=ok
[[1;34mINFO[m] [1;32mTests run: [0;1;32m5[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.169 s -- in com.datadistributor.inadapter.scheduler.[1mSignalEventSchedulerTest[m
[[1;34mINFO[m] Running com.datadistributor.inadapter.scheduler.[1mSignalEventRetrySchedulerTest[m
2025-12-07T22:31:06.701+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.s.SignalEventRetryScheduler        : Retry schedule disabled via config
2025-12-07T22:31:06.703+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.s.SignalEventRetryScheduler        : Retry scheduler kicking off jobId=retry-77f2c914-5371-408d-aa55-7a28a35c31ae for date=2024-12-03
2025-12-07T22:31:06.704+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.s.SignalEventRetryScheduler        : Retry jobId=retry-77f2c914-5371-408d-aa55-7a28a35c31ae for date=2024-12-03 finished. success=0 failure=0 message=ok
2025-12-07T22:31:06.707+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.s.SignalEventRetryScheduler        : Retry schedule skipped for Monday 2024-12-02
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s -- in com.datadistributor.inadapter.scheduler.[1mSignalEventRetrySchedulerTest[m
[[1;34mINFO[m] Running com.datadistributor.integration.[1mFeignFailureIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:31:07.346+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FeignFailureIntegrationTest        : Starting FeignFailureIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:31:07.346+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FeignFailureIntegrationTest        : The following 1 profile is active: "test"
2025-12-07T22:31:10.329+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:31:11.909+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 1380 ms. Found 5 JPA repository interfaces.
2025-12-07T22:31:16.273+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=fdf20ac5-1b2d-33e6-b08d-219ee4f10076
2025-12-07T22:31:18.696+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:31:19.011+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-12-07T22:31:19.212+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:31:20.022+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:31:20.203+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-12-07T22:31:21.366+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:31:21.372+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-12-07T22:31:21.494+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:31:21.601+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:31:26.383+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:31:26.788+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:31:28.432+01:00  INFO 210330 --- [data-distributor] [           main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-12-07T22:31:38.020+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FeignFailureIntegrationTest        : Started FeignFailureIntegrationTest in 31.066 seconds (process running for 51.011)
2025-12-07T22:31:38.764+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:38.764+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 32.13 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mFeignFailureIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.FeignFailureIntegrationTest.feignBlockingFailurePersistsAudit -- Time elapsed: 0.779 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.support.TestSignalDataSeeder.seedSignalEvents(TestSignalDataSeeder.java:67)
	at com.datadistributor.integration.FeignFailureIntegrationTest.feignBlockingFailurePersistsAudit(FeignFailureIntegrationTest.java:56)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 60 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mInitialCehPropagationIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:31:39.162+01:00  INFO 210330 --- [data-distributor] [           main] d.i.InitialCehPropagationIntegrationTest : Starting InitialCehPropagationIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:31:39.162+01:00  INFO 210330 --- [data-distributor] [           main] d.i.InitialCehPropagationIntegrationTest : The following 1 profile is active: "test"
2025-12-07T22:31:39.895+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:31:39.914+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 16 ms. Found 5 JPA repository interfaces.
2025-12-07T22:31:39.917+01:00  INFO 210330 --- [data-distributor] [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'webClient' with a different definition: replacing [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=webClientConfiguration; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/datadistributor/application/config/WebClientConfiguration.class]] with [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; fallback=false; factoryBeanName=stubExternalApiConfig; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in com.datadistributor.support.StubExternalApiConfig]
2025-12-07T22:31:41.165+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=43ec6a6b-d53f-3071-878a-57fb01769bf5
2025-12-07T22:31:42.284+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:31:42.295+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:31:42.442+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:31:42.479+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Starting...
2025-12-07T22:31:42.499+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:31:42.500+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Start completed.
2025-12-07T22:31:42.500+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:31:42.501+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:31:42.970+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:31:43.091+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:31:47.098+01:00  INFO 210330 --- [data-distributor] [           main] d.i.InitialCehPropagationIntegrationTest : Started InitialCehPropagationIntegrationTest in 8.119 seconds (process running for 60.09)
2025-12-07T22:31:47.225+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:47.226+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 8.274 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mInitialCehPropagationIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.InitialCehPropagationIntegrationTest.initialCehIdStoredOnFirstOverlimitAndReused -- Time elapsed: 0.133 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.InitialCehPropagationIntegrationTest.initialCehIdStoredOnFirstOverlimitAndReused(InitialCehPropagationIntegrationTest.java:19)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 60 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mPrerequisiteFlowIntegrationTest[m
2025-12-07T22:31:47.414+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:47.415+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
2025-12-07T22:31:47.513+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:47.513+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
2025-12-07T22:31:47.628+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:47.629+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
2025-12-07T22:31:47.761+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:47.762+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m4[m, Failures: 0, [1;31mErrors: [0;1;31m4[m, Skipped: 0, Time elapsed: 0.530 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mPrerequisiteFlowIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchAbortsWhenPriorAuditMissing -- Time elapsed: 0.139 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchAbortsWhenPriorAuditMissing(PrerequisiteFlowIntegrationTest.java:18)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 60 more

[[1;31mERROR[m] com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchProceedsWhenPriorAuditPasses -- Time elapsed: 0.099 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchProceedsWhenPriorAuditPasses(PrerequisiteFlowIntegrationTest.java:32)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 60 more

[[1;31mERROR[m] com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchProceedsWhenFinalPriorAuditIsPassAfterFails -- Time elapsed: 0.138 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchProceedsWhenFinalPriorAuditIsPassAfterFails(PrerequisiteFlowIntegrationTest.java:68)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 60 more

[[1;31mERROR[m] com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchAbortsWhenLatestPriorAuditIsFailAfterRetries -- Time elapsed: 0.098 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.PrerequisiteFlowIntegrationTest.batchAbortsWhenLatestPriorAuditIsFailAfterRetries(PrerequisiteFlowIntegrationTest.java:50)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mConfigBindingIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:31:47.988+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.ConfigBindingIntegrationTest       : Starting ConfigBindingIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:31:47.989+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.ConfigBindingIntegrationTest       : The following 1 profile is active: "test"
2025-12-07T22:31:48.853+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:31:48.912+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 56 ms. Found 5 JPA repository interfaces.
2025-12-07T22:31:48.913+01:00  INFO 210330 --- [data-distributor] [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'webClient' with a different definition: replacing [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=webClientConfiguration; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/datadistributor/application/config/WebClientConfiguration.class]] with [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; fallback=false; factoryBeanName=stubExternalApiConfig; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in com.datadistributor.support.StubExternalApiConfig]
2025-12-07T22:31:49.523+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=43ec6a6b-d53f-3071-878a-57fb01769bf5
2025-12-07T22:31:49.912+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:31:49.916+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:31:49.962+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:31:49.963+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Starting...
2025-12-07T22:31:49.965+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-3 - Added connection conn20: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:31:49.966+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Start completed.
2025-12-07T22:31:49.966+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:31:49.967+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:31:50.273+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:31:50.301+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:31:53.081+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.ConfigBindingIntegrationTest       : Started ConfigBindingIntegrationTest in 5.288 seconds (process running for 66.073)
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 5.476 s -- in com.datadistributor.integration.[1mConfigBindingIntegrationTest[m
[[1;34mINFO[m] Running com.datadistributor.integration.[1mDateFilteringIntegrationTest[m
2025-12-07T22:31:53.342+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:31:53.343+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 0.106 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mDateFilteringIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.DateFilteringIntegrationTest.processesOnlyEventsMatchingTargetDate -- Time elapsed: 0.090 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.DateFilteringIntegrationTest.processesOnlyEventsMatchingTargetDate(DateFilteringIntegrationTest.java:13)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mFailureFlowIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:31:53.547+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FailureFlowIntegrationTest         : Starting FailureFlowIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:31:53.547+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FailureFlowIntegrationTest         : The following 1 profile is active: "test"
2025-12-07T22:31:54.620+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:31:54.635+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 13 ms. Found 5 JPA repository interfaces.
2025-12-07T22:31:54.636+01:00  INFO 210330 --- [data-distributor] [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'webClient' with a different definition: replacing [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=webClientConfiguration; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/datadistributor/application/config/WebClientConfiguration.class]] with [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; fallback=false; factoryBeanName=stubExternalApiConfig; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in com.datadistributor.support.StubExternalApiConfig]
2025-12-07T22:31:55.180+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=43ec6a6b-d53f-3071-878a-57fb01769bf5
2025-12-07T22:31:55.821+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:31:55.840+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:31:55.866+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:31:55.867+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Starting...
2025-12-07T22:31:55.868+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-4 - Added connection conn30: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:31:55.869+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Start completed.
2025-12-07T22:31:55.869+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:31:55.870+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-4)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:31:56.779+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:31:56.881+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:32:00.470+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.FailureFlowIntegrationTest         : Started FailureFlowIntegrationTest in 7.05 seconds (process running for 73.462)
2025-12-07T22:32:00.556+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:00.556+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 7.195 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mFailureFlowIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.FailureFlowIntegrationTest.auditRecordsFailureWhenExternalApiFails -- Time elapsed: 0.092 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.AbstractIntegrationTest.saveEvent(AbstractIntegrationTest.java:75)
	at com.datadistributor.integration.FailureFlowIntegrationTest.auditRecordsFailureWhenExternalApiFails(FailureFlowIntegrationTest.java:16)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mSignalEventDeliveryReportFileTest[m
2025-12-07T22:32:00.638+01:00  INFO 210330 --- [data-distributor] [           main] d.d.s.SignalEventProcessingDomainService : 🚀 Starting processing for 3 events on 2025-12-02 (~1 batches)
2025-12-07T22:32:00.644+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job-1 started with 1 batches
2025-12-07T22:32:00.646+01:00  INFO 210330 --- [data-distributor] [           main] d.d.s.SignalEventProcessingDomainService : Submitting batch #1 (size 3) on thread main | uabsEventIds=[1,2,3]
2025-12-07T22:32:00.649+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job-1 batch #1 (size 3) complete. Batch success=2 failure=1. Progress: 1/1 batches done (success=2, failure=1)
2025-12-07T22:32:00.650+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job-1 finished. Total success=2 failure=1
2025-12-07T22:32:00.654+01:00  INFO 210330 --- [data-distributor] [           main] d.d.s.SignalEventProcessingDomainService : ✅ Processing finished for 2025-12-02. success=2 failure=1
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.061 s -- in com.datadistributor.integration.[1mSignalEventDeliveryReportFileTest[m
[[1;34mINFO[m] Running com.datadistributor.integration.[1mDialSignalDataExportServiceFileTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.031 s -- in com.datadistributor.integration.[1mDialSignalDataExportServiceFileTest[m
[[1;34mINFO[m] Running com.datadistributor.integration.[1mSignalDispatchSelectorIntegrationTest[m
2025-12-07T22:32:00.855+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:00.855+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
2025-12-07T22:32:01.025+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:01.026+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
2025-12-07T22:32:01.323+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:01.323+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m3[m, Failures: 0, [1;31mErrors: [0;1;31m3[m, Skipped: 0, Time elapsed: 0.668 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mSignalDispatchSelectorIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.breachThenClosureSendsClosure -- Time elapsed: 0.134 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.saveEventWithBalance(SignalDispatchSelectorIntegrationTest.java:121)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.breachThenClosureSendsClosure(SignalDispatchSelectorIntegrationTest.java:59)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;31mERROR[m] com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.noBreachThenClosureSendsNothing -- Time elapsed: 0.171 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.saveEventWithBalance(SignalDispatchSelectorIntegrationTest.java:121)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.noBreachThenClosureSendsNothing(SignalDispatchSelectorIntegrationTest.java:79)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;31mERROR[m] com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.breachThenFollowUpAfterInitialSent -- Time elapsed: 0.297 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.saveEventWithBalance(SignalDispatchSelectorIntegrationTest.java:121)
	at com.datadistributor.integration.SignalDispatchSelectorIntegrationTest.breachThenFollowUpAfterInitialSent(SignalDispatchSelectorIntegrationTest.java:38)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mWebClientFailureIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:32:01.868+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.WebClientFailureIntegrationTest    : Starting WebClientFailureIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:32:01.868+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.WebClientFailureIntegrationTest    : The following 1 profile is active: "test"
2025-12-07T22:32:02.315+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:32:02.361+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 5 JPA repository interfaces.
2025-12-07T22:32:02.363+01:00  INFO 210330 --- [data-distributor] [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'webClient' with a different definition: replacing [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=webClientConfiguration; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/datadistributor/application/config/WebClientConfiguration.class]] with [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; fallback=false; factoryBeanName=failingWebClientStubConfig; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in com.datadistributor.support.FailingWebClientStubConfig]
2025-12-07T22:32:02.676+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=3bb47064-b20d-3bc2-899d-5f0378b5d079
2025-12-07T22:32:02.934+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:32:02.938+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:32:02.961+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:32:02.962+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Starting...
2025-12-07T22:32:02.964+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-5 - Added connection conn40: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:32:02.964+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Start completed.
2025-12-07T22:32:02.965+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:32:02.965+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-5)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:32:03.130+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:32:03.161+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:32:05.919+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.WebClientFailureIntegrationTest    : Started WebClientFailureIntegrationTest in 4.512 seconds (process running for 78.911)
2025-12-07T22:32:05.965+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:05.966+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 4.606 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mWebClientFailureIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.WebClientFailureIntegrationTest.webClientRetriesAndAuditsOnFailure -- Time elapsed: 0.079 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.support.TestSignalDataSeeder.seedSignalEvents(TestSignalDataSeeder.java:67)
	at com.datadistributor.integration.WebClientFailureIntegrationTest.webClientRetriesAndAuditsOnFailure(WebClientFailureIntegrationTest.java:60)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mOverdueDispatchIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:32:06.202+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.OverdueDispatchIntegrationTest     : Starting OverdueDispatchIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:32:06.202+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.OverdueDispatchIntegrationTest     : The following 1 profile is active: "test"
2025-12-07T22:32:06.602+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:32:06.615+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 5 JPA repository interfaces.
2025-12-07T22:32:06.907+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=fdf20ac5-1b2d-33e6-b08d-219ee4f10076
2025-12-07T22:32:07.166+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:32:07.170+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:32:07.184+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:32:07.185+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Starting...
2025-12-07T22:32:07.187+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-6 - Added connection conn50: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:32:07.187+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Start completed.
2025-12-07T22:32:07.188+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:32:07.188+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-6)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:32:07.353+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:32:07.376+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:32:09.788+01:00  INFO 210330 --- [data-distributor] [           main] c.d.i.OverdueDispatchIntegrationTest     : Started OverdueDispatchIntegrationTest in 3.763 seconds (process running for 82.78)
2025-12-07T22:32:09.938+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23502, SQLState: 23502
2025-12-07T22:32:09.939+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : NULL not allowed for column "GRV"; SQL statement:
insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default) [23502-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 3.947 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mOverdueDispatchIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.OverdueDispatchIntegrationTest.sendsEarliestOverlimitWhenDpdExceedsThresholdEvenWithoutTodayEvent -- Time elapsed: 0.158 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [NULL not allowed for column "GRV"; SQL statement:
insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default) [23502-232]] [insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default)]; SQL [insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default)]; constraint [null]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.integration.OverdueDispatchIntegrationTest.sendsEarliestOverlimitWhenDpdExceedsThresholdEvenWithoutTodayEvent(OverdueDispatchIntegrationTest.java:67)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [NULL not allowed for column "GRV"; SQL statement:
insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default) [23502-232]] [insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:62)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:116)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:47)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:95)
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:85)
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:682)
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:293)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:274)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 9 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: NULL not allowed for column "GRV"; SQL statement:
insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default) [23502-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.table.Column.validateConvertUpdateSequence(Column.java:402)
	at org.h2.table.Table.convertInsertRow(Table.java:963)
	at org.h2.command.dml.Insert.insertRows(Insert.java:167)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.CommandContainer.executeUpdateWithGeneratedKeys(CommandContainer.java:212)
	at org.h2.command.CommandContainer.update(CommandContainer.java:133)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 58 more

[[1;34mINFO[m] Running com.datadistributor.integration.[1mWebClientCircuitOpenIntegrationTest[m

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-12-07T22:32:10.447+01:00  INFO 210330 --- [data-distributor] [           main] .d.i.WebClientCircuitOpenIntegrationTest : Starting WebClientCircuitOpenIntegrationTest using Java 17.0.17 with PID 210330 (started by ashu in /home/ashu/git/codex/data-distributor)
2025-12-07T22:32:10.447+01:00  INFO 210330 --- [data-distributor] [           main] .d.i.WebClientCircuitOpenIntegrationTest : The following 1 profile is active: "test"
2025-12-07T22:32:11.890+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-07T22:32:11.915+01:00  INFO 210330 --- [data-distributor] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 23 ms. Found 5 JPA repository interfaces.
2025-12-07T22:32:11.916+01:00  INFO 210330 --- [data-distributor] [           main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'webClient' with a different definition: replacing [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=webClientConfiguration; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/datadistributor/application/config/WebClientConfiguration.class]] with [Root bean: class=null; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; fallback=false; factoryBeanName=failingWebClientStubConfig; factoryMethodName=webClient; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in com.datadistributor.support.FailingWebClientStubConfig]
2025-12-07T22:32:12.819+01:00  INFO 210330 --- [data-distributor] [           main] o.s.cloud.context.scope.GenericScope     : BeanFactory id=3bb47064-b20d-3bc2-899d-5f0378b5d079
2025-12-07T22:32:13.445+01:00  INFO 210330 --- [data-distributor] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-07T22:32:13.483+01:00  INFO 210330 --- [data-distributor] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-07T22:32:13.501+01:00  INFO 210330 --- [data-distributor] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-07T22:32:13.502+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Starting...
2025-12-07T22:32:13.504+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-7 - Added connection conn60: url=jdbc:h2:mem:testdb user=SA
2025-12-07T22:32:13.504+01:00  INFO 210330 --- [data-distributor] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Start completed.
2025-12-07T22:32:13.505+01:00  WARN 210330 --- [data-distributor] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-07T22:32:13.505+01:00  INFO 210330 --- [data-distributor] [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-7)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-07T22:32:13.815+01:00  INFO 210330 --- [data-distributor] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-07T22:32:13.917+01:00  INFO 210330 --- [data-distributor] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-07T22:32:16.744+01:00  INFO 210330 --- [data-distributor] [           main] .d.i.WebClientCircuitOpenIntegrationTest : Started WebClientCircuitOpenIntegrationTest in 6.673 seconds (process running for 89.736)
2025-12-07T22:32:16.791+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:16.791+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 6.798 s[1;31m <<< FAILURE![m -- in com.datadistributor.integration.[1mWebClientCircuitOpenIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.integration.WebClientCircuitOpenIntegrationTest.circuitOpenAuditsBlock -- Time elapsed: 0.052 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.support.TestSignalDataSeeder.seedSignalEvents(TestSignalDataSeeder.java:67)
	at com.datadistributor.integration.WebClientCircuitOpenIntegrationTest.circuitOpenAuditsBlock(WebClientCircuitOpenIntegrationTest.java:68)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mSignalQueryServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s -- in com.datadistributor.domain.service.[1mSignalQueryServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mAccountBalanceServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.136 s -- in com.datadistributor.domain.service.[1mAccountBalanceServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mDialSignalDataExportServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s -- in com.datadistributor.domain.service.[1mDialSignalDataExportServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mInitialCehMappingServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 s -- in com.datadistributor.domain.service.[1mInitialCehMappingServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mSignalEventRetryServiceTest[m
2025-12-07T22:32:16.999+01:00  INFO 210330 --- [data-distributor] [           main] c.d.d.s.SignalEventRetryDomainService    : 🔁 Retry finished for 2024-12-03 success=1 failure=1 (missing=1)
2025-12-07T22:32:17.002+01:00  INFO 210330 --- [data-distributor] [           main] c.d.d.s.SignalEventRetryDomainService    : 🔁 Retry finished for 2024-12-03 success=3 failure=0 (missing=0)
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.048 s -- in com.datadistributor.domain.service.[1mSignalEventRetryServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mInitialCehQueryServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s -- in com.datadistributor.domain.service.[1mInitialCehQueryServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mSignalDispatchSelectorTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m7[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.139 s -- in com.datadistributor.domain.service.[1mSignalDispatchSelectorTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mSignalDispatchDomainSelectorTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m7[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.307 s -- in com.datadistributor.domain.service.[1mSignalDispatchDomainSelectorTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.service.[1mSignalEventDomainServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.071 s -- in com.datadistributor.domain.service.[1mSignalEventDomainServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.job.[1mBatchResultTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s -- in com.datadistributor.domain.job.[1mBatchResultTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.job.[1mJobResultTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 s -- in com.datadistributor.domain.job.[1mJobResultTest[m
[[1;34mINFO[m] Running com.datadistributor.domain.job.[1mJobProgressTrackerTest[m
2025-12-07T22:32:17.717+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job started with 2 batches
2025-12-07T22:32:17.717+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job batch #1 (size 5) complete. Batch success=1 failure=0. Progress: 1/2 batches done (success=1, failure=0)
2025-12-07T22:32:17.717+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job batch #2 (size 5) complete. Batch success=2 failure=3. Progress: 2/2 batches done (success=3, failure=3)
2025-12-07T22:32:17.717+01:00  INFO 210330 --- [data-distributor] [           main] c.d.domain.job.JobProgressTracker        : Job job finished. Total success=3 failure=3
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.044 s -- in com.datadistributor.domain.job.[1mJobProgressTrackerTest[m
[[1;34mINFO[m] Running com.datadistributor.[1mSignalProcessingIntegrationTest[m
2025-12-07T22:32:17.817+01:00  WARN 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 23505, SQLState: 23505
2025-12-07T22:32:17.817+01:00 ERROR 210330 --- [data-distributor] [           main] o.h.engine.jdbc.spi.SqlExceptionHelper   : Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
[[1;31mERROR[m] [1;31mTests [0;1mrun: [0;1m1[m, Failures: 0, [1;31mErrors: [0;1;31m1[m, Skipped: 0, Time elapsed: 0.060 s[1;31m <<< FAILURE![m -- in com.datadistributor.[1mSignalProcessingIntegrationTest[m
[[1;31mERROR[m] com.datadistributor.SignalProcessingIntegrationTest.asyncEndpointProcessesAllEventsAndPersistsStatus -- Time elapsed: 0.053 s <<< ERROR!
org.springframework.dao.DataIntegrityViolationException: 
could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy167.save(Unknown Source)
	at com.datadistributor.support.TestSignalDataSeeder.seedSignalEvents(TestSignalDataSeeder.java:67)
	at com.datadistributor.SignalProcessingIntegrationTest.setup(SignalProcessingIntegrationTest.java:51)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]
	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$3(H2Dialect.java:759)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeInserts(ActionQueue.java:486)
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:269)
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:324)
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:394)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:308)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:224)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy163.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:654)
	at jdk.internal.reflect.GeneratedMethodAccessor74.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:734)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 10 more
Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.message.DbException.get(DbException.java:199)
	at org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
	at org.h2.mvstore.db.MVTable.addRow(MVTable.java:517)
	at org.h2.command.dml.Insert.insertRows(Insert.java:174)
	at org.h2.command.dml.Insert.update(Insert.java:135)
	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:74)
	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
	at org.h2.command.Command.executeUpdate(Command.java:304)
	at org.h2.command.Command.executeUpdate(Command.java:248)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 59 more

[[1;34mINFO[m] Running com.datadistributor.application.config.[1mDataDistributorPropertiesTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s -- in com.datadistributor.application.config.[1mDataDistributorPropertiesTest[m
[[1;34mINFO[m] Running com.datadistributor.application.config.[1mAsyncConfigurationTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s -- in com.datadistributor.application.config.[1mAsyncConfigurationTest[m
[[1;34mINFO[m] Running com.datadistributor.application.config.[1mWebClientConfigurationTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.493 s -- in com.datadistributor.application.config.[1mWebClientConfigurationTest[m
[[1;34mINFO[m] Running com.datadistributor.application.config.[1mFeignConfigurationTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 s -- in com.datadistributor.application.config.[1mFeignConfigurationTest[m
[[1;34mINFO[m] Running com.datadistributor.application.security.[1mKeyVaultSslContextProviderCoverageTest[m
2025-12-07T22:32:19.384+01:00  WARN 210330 --- [data-distributor] [           main] c.d.a.s.KeyVaultSslContextProvider       : KeyVault SSL context not loaded: vaultUrl or certificateName missing
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 s -- in com.datadistributor.application.security.[1mKeyVaultSslContextProviderCoverageTest[m
[[1;34mINFO[m] Running com.datadistributor.application.security.[1mKeyVaultSslContextProviderTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s -- in com.datadistributor.application.security.[1mKeyVaultSslContextProviderTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mSignalAuditServiceTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.551 s -- in com.datadistributor.outadapter.web.[1mSignalAuditServiceTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mBlockingSignalEventClientTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.319 s -- in com.datadistributor.outadapter.web.[1mBlockingSignalEventClientTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mSignalEventRequestFactoryTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.103 s -- in com.datadistributor.outadapter.web.[1mSignalEventRequestFactoryTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mSignalEventPayloadFactoryAdditionalTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.033 s -- in com.datadistributor.outadapter.web.[1mSignalEventPayloadFactoryAdditionalTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mReactiveSignalEventClientTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m1[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.539 s -- in com.datadistributor.outadapter.web.[1mReactiveSignalEventClientTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mErrorClassifierTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.046 s -- in com.datadistributor.outadapter.web.[1mErrorClassifierTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.web.[1mSignalEventBatchSenderTest[m
2025-12-07T22:32:21.378+01:00 DEBUG 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ➡️  [1] Sending uabsEventId=3 to http://example
2025-12-07T22:32:21.389+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ✅ Posted uabsEventId=3 | ceh_event_id=321 | thread=main
2025-12-07T22:32:21.394+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : 🚀 Sending batch of 1 events | concurrencyCap=20 | thread=main
2025-12-07T22:32:21.409+01:00 DEBUG 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ➡️  [2] Sending uabsEventId=1 to http://example
2025-12-07T22:32:21.410+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ✅ Posted uabsEventId=1 | ceh_event_id=123 | thread=main
2025-12-07T22:32:21.410+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ✅ Batch completed: 1 success / 0 failure
2025-12-07T22:32:21.448+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : 🚀 Sending batch of 1 events | concurrencyCap=20 | thread=main
2025-12-07T22:32:21.448+01:00 DEBUG 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ➡️  [3] Sending uabsEventId=2 to http://example
2025-12-07T22:32:21.457+01:00  WARN 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : 💾 Persisting FAIL for uabsEventId=2 | status=FAIL | reason=reason | error=java.lang.RuntimeException: boom
2025-12-07T22:32:21.458+01:00 ERROR 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ❌ Final failure for uabsEventId=2 | status=FAIL | error=java.lang.RuntimeException: boom | thread=main
2025-12-07T22:32:21.458+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.web.SignalEventBatchSender         : ✅ Batch completed: 0 success / 1 failure
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.351 s -- in com.datadistributor.outadapter.web.[1mSignalEventBatchSenderTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.entity.[1mEntityRoundTripTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m5[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 s -- in com.datadistributor.outadapter.entity.[1mEntityRoundTripTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.report.[1mAzureBlobStorageClientTest[m
2025-12-07T22:32:21.490+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.report.AzureBlobStorageClient      : Uploaded blob folder/file.txt to container my-container
2025-12-07T22:32:21.496+01:00  INFO 210330 --- [data-distributor] [           main] c.d.o.report.AzureBlobStorageClient      : Uploaded blob file.txt to container my-container
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 s -- in com.datadistributor.outadapter.report.[1mAzureBlobStorageClientTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.report.[1mAzureBlobComponentsTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.182 s -- in com.datadistributor.outadapter.report.[1mAzureBlobComponentsTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mSignalRepositoryAdapterTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m6[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.318 s -- in com.datadistributor.outadapter.repository.adapter.[1mSignalRepositoryAdapterTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mSignalEventMapperTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.034 s -- in com.datadistributor.outadapter.repository.adapter.[1mSignalEventMapperTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mInitialCehMappingRepositoryAdapterTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m3[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.192 s -- in com.datadistributor.outadapter.repository.adapter.[1mInitialCehMappingRepositoryAdapterTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mSignalMapperTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m2[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s -- in com.datadistributor.outadapter.repository.adapter.[1mSignalMapperTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mSignalEventRepositoryAdapterTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m9[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.307 s -- in com.datadistributor.outadapter.repository.adapter.[1mSignalEventRepositoryAdapterTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mSignalAuditQueryRepositoryAdapterTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.039 s -- in com.datadistributor.outadapter.repository.adapter.[1mSignalAuditQueryRepositoryAdapterTest[m
[[1;34mINFO[m] Running com.datadistributor.outadapter.repository.adapter.[1mAccountBalanceOverviewRepositoryAdapterTest[m
[[1;34mINFO[m] [1;32mTests run: [0;1;32m4[m, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.107 s -- in com.datadistributor.outadapter.repository.adapter.[1mAccountBalanceOverviewRepositoryAdapterTest[m
[[1;34mINFO[m] 
[[1;34mINFO[m] Results:
[[1;34mINFO[m] 
[[1;31mERROR[m] [1;31mErrors: [m
[[1;31mERROR[m] [1;31m  SignalProcessingIntegrationTest.setup:51 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  DateFilteringIntegrationTest.processesOnlyEventsMatchingTargetDate:13->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  FailureFlowIntegrationTest.auditRecordsFailureWhenExternalApiFails:16->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  FeignFailureIntegrationTest.feignBlockingFailurePersistsAudit:56 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  InitialCehPropagationIntegrationTest.initialCehIdStoredOnFirstOverlimitAndReused:19->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  OverdueDispatchIntegrationTest.sendsEarliestOverlimitWhenDpdExceedsThresholdEvenWithoutTodayEvent:67 » DataIntegrityViolation could not execute statement [NULL not allowed for column "GRV"; SQL statement:
insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default) [23502-232]] [insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default)]; SQL [insert into signal_events (agreement_id,book_date,event_record_date_time,event_status,event_type,grv,product_id,signal_id,unauthorized_debit_balance,uabs_event_id) values (?,?,?,?,?,?,?,?,?,default)]; constraint [null][m
[[1;31mERROR[m] [1;31m  PrerequisiteFlowIntegrationTest.batchAbortsWhenLatestPriorAuditIsFailAfterRetries:50->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  PrerequisiteFlowIntegrationTest.batchAbortsWhenPriorAuditMissing:18->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  PrerequisiteFlowIntegrationTest.batchProceedsWhenFinalPriorAuditIsPassAfterFails:68->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  PrerequisiteFlowIntegrationTest.batchProceedsWhenPriorAuditPasses:32->AbstractIntegrationTest.saveEvent:75 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  SignalDispatchSelectorIntegrationTest.breachThenClosureSendsClosure:59->saveEventWithBalance:121 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  SignalDispatchSelectorIntegrationTest.breachThenFollowUpAfterInitialSent:38->saveEventWithBalance:121 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  SignalDispatchSelectorIntegrationTest.noBreachThenClosureSendsNothing:79->saveEventWithBalance:121 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  WebClientCircuitOpenIntegrationTest.circuitOpenAuditsBlock:68 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;31mERROR[m] [1;31m  WebClientFailureIntegrationTest.webClientRetriesAndAuditsOnFailure:60 » DataIntegrityViolation could not execute statement [Unique index or primary key violation: "PRIMARY KEY ON PUBLIC.PRODUCT_RISK_MONITORING(GRV) ( /* key:1 */ CAST('EUR' AS CHAR(3)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)), CAST(1 AS SMALLINT), CAST('Y' AS CHAR(1)), CAST('Y' AS CHAR(1)))"; SQL statement:
insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?) [23505-232]] [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; SQL [insert into product_risk_monitoring (currency_code,monitor_cw014_signal,monitor_kraandicht,product_id,report_cw014_to_ceh,report_cw014_to_dial,grv) values (?,?,?,?,?,?,?)]; constraint [PRIMARY KEY][m
[[1;34mINFO[m] 
[[1;31mERROR[m] [1;31mTests run: 138, Failures: 0, Errors: 15, Skipped: 0[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;31mBUILD FAILURE[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time:  02:05 min
[[1;34mINFO[m] Finished at: 2025-12-07T22:32:24+01:00
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;31mERROR[m] Failed to execute goal [32morg.apache.maven.plugins:maven-surefire-plugin:3.2.5:test[m [1m(default-test)[m on project [36mdata-distributor[m: [1;31m[m
[[1;31mERROR[m] [1;31m[m
[[1;31mERROR[m] [1;31mPlease refer to /home/ashu/git/codex/data-distributor/target/surefire-reports for the individual test results.[m
[[1;31mERROR[m] [1;31mPlease refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.[m
[[1;31mERROR[m] -> [1m[Help 1][m
[[1;31mERROR[m] 
[[1;31mERROR[m] To see the full stack trace of the errors, re-run Maven with the [1m-e[m switch.
[[1;31mERROR[m] Re-run Maven using the [1m-X[m switch to enable full debug logging.
[[1;31mERROR[m] 
[[1;31mERROR[m] For more information about the errors and possible solutions, please read the following articles:
[[1;31mERROR[m] [1m[Help 1][m http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
